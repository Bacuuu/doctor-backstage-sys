<!DOCTYPE html>
<!-- saved from url=(0047)http://pratikborsadiya.in/vali-admin/index.html -->
<html lang="en" class="gr__pratikborsadiya_in">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>脊柱侧弯患者管理系统</title>
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Main CSS-->
    <link rel="stylesheet" type="text/css" href="../public/css/main.css">
    <!-- Font-icon css-->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- <link href="https://cdn.staticfile.org/font-awesome/5.8.1/css/all.min.css" rel="stylesheet"> -->
    
    <!-- slider -->
    <link rel="stylesheet" href="https://cdn.staticfile.org/jqueryui/1.12.1/jquery-ui.css">
    <script src="https://cdn.staticfile.org/jquery/3.4.0/jquery.js"></script>
    <script src="https://cdn.staticfile.org/jqueryui/1.12.1/jquery-ui.js"></script>

    <script src="https://cdn.staticfile.org/echarts/4.2.1-rc1/echarts.min.js"></script>

  </head>
  <body class="app sidebar-mini rtl  pace-done" data-gr-c-s-loaded="true"><div class="pace  pace-inactive"><div class="pace-progress" data-progress-text="100%" data-progress="99" style="transform: translate3d(100%, 0px, 0px);">
  <div class="pace-progress-inner"></div>
</div>
<div class="pace-activity"></div></div>
    <!-- Navbar-->
    <header class="app-header"><a class="app-header__logo" href="http://pratikborsadiya.in/vali-admin/index.html">Spms</a>
      <!-- Sidebar toggle button--><a class="app-sidebar__toggle" href="http://pratikborsadiya.in/vali-admin/index.html#" data-toggle="sidebar" aria-label="Hide Sidebar"></a>
      <!-- Navbar Right Menu-->
      <ul class="app-nav">
        <!-- <li class="app-search">
          <input class="app-search__input" type="search" placeholder="Search">
          <button class="app-search__button"><i class="fa fa-search"></i></button>
        </li> -->
        <!--Notification Menu-->
        <!-- 消息提醒 -->
        <li class="dropdown"><a class="app-nav__item" href="http://pratikborsadiya.in/vali-admin/index.html#" data-toggle="dropdown" aria-label="Show notifications"><i class="fa fa-bell-o fa-lg"></i></a>
          <ul class="app-notification dropdown-menu dropdown-menu-right">
            <li class="app-notification__title">You have 4 new notifications.</li>
            <div class="app-notification__content">
              <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-primary"></i><i class="fa fa-envelope fa-stack-1x fa-inverse"></i></span></span>
                  <div>
                    <p class="app-notification__message">Lisa sent you a mail</p>
                    <p class="app-notification__meta">2 min ago</p>
                  </div></a></li>
              <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-danger"></i><i class="fa fa-hdd-o fa-stack-1x fa-inverse"></i></span></span>
                  <div>
                    <p class="app-notification__message">Mail server not working</p>
                    <p class="app-notification__meta">5 min ago</p>
                  </div></a></li>
              <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-success"></i><i class="fa fa-money fa-stack-1x fa-inverse"></i></span></span>
                  <div>
                    <p class="app-notification__message">Transaction complete</p>
                    <p class="app-notification__meta">2 days ago</p>
                  </div></a></li>
              <div class="app-notification__content">
                <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-primary"></i><i class="fa fa-envelope fa-stack-1x fa-inverse"></i></span></span>
                    <div>
                      <p class="app-notification__message">Lisa sent you a mail</p>
                      <p class="app-notification__meta">2 min ago</p>
                    </div></a></li>
                <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-danger"></i><i class="fa fa-hdd-o fa-stack-1x fa-inverse"></i></span></span>
                    <div>
                      <p class="app-notification__message">Mail server not working</p>
                      <p class="app-notification__meta">5 min ago</p>
                    </div></a></li>
                <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-success"></i><i class="fa fa-money fa-stack-1x fa-inverse"></i></span></span>
                    <div>
                      <p class="app-notification__message">Transaction complete</p>
                      <p class="app-notification__meta">2 days ago</p>
                    </div></a></li>
              </div>
            </div>
            <li class="app-notification__footer"><a href="http://pratikborsadiya.in/vali-admin/index.html#">See all notifications.</a></li>
          </ul>
        </li>
        <!-- User Menu-->
        <!-- 用户菜单 -->
        <li class="dropdown"><a class="app-nav__item" href="http://pratikborsadiya.in/vali-admin/index.html#" data-toggle="dropdown" aria-label="Open Profile Menu"><i class="fa fa-user fa-lg"></i></a>
          <ul class="dropdown-menu settings-menu dropdown-menu-right">
            <li><a class="dropdown-item" href="http://pratikborsadiya.in/vali-admin/page-user.html"><i class="fa fa-cog fa-lg"></i> Settings</a></li>
            <li><a class="dropdown-item" href="http://pratikborsadiya.in/vali-admin/page-user.html"><i class="fa fa-user fa-lg"></i> Profile</a></li>
            <li><a class="dropdown-item" href="http://pratikborsadiya.in/vali-admin/page-login.html"><i class="fa fa-sign-out fa-lg"></i> Logout</a></li>
          </ul>
        </li>
      </ul>
    </header>
    <!-- Sidebar menu-->
    <div class="app-sidebar__overlay" data-toggle="sidebar"></div>

    <aside class="app-sidebar">
      <div class="app-sidebar__user"><img class="app-sidebar__user-avatar" src="../public/assets/img/48.jpg" alt="User Image">
        <div>
          <p class="app-sidebar__user-name">{{user_info.name}}</p>
          <p class="app-sidebar__user-designation"></p>
        </div>
      </div>

 
      <div class="panel-group" id="accordion">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a style="color:white;margin-left:30px">
                 5°-15°患者 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
              </a><a data-toggle="collapse" data-parent="#accordion"  href="#collapseOne"><i class="fa fa-chevron-down" style="color:white"></i></a>
            </h4>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" style="color:white">
            <div class="panel-body">
              <ul class="app-menu">
                {% for item in user_info.patient %}
                  {% if item.category == '0' %}
                    {% if item.debuff %}
                      <li><a class="app-menu__item" id='{{item._id}}' style="background-color:coral">
                    {% else %}
                      <li><a class="app-menu__item" id='{{item._id}}'>
                    {% endif %}
                      <i class="app-menu__icon fa fa-dashboard"></i>
                    {% if item.buff %}
                      <span class="app-menu__label">{{item.basicInfo.name}}</span><i class="fa fa-flag" style="color:crimson"></i></a>
                    {% else %}
                      <span class="app-menu__label">{{item.basicInfo.name}}</span><i class="fa fa-flag-o"></i></a>
                    {% endif %}
                    </li>
                  {% endif %}
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a style="color:white;margin-left:30px">
                 15°-25°患者 &nbsp;&nbsp;&nbsp;
              </a><a data-toggle="collapse" data-parent="#accordion"  href="#collapseTwo"><i class="fa fa-chevron-down" style="color:white"></i></a>
            </h4>
          </div>
          <div id="collapseTwo" class="panel-collapse collapse" style="color:white">
            <div class="panel-body">
              <ul class="app-menu">
                {% for item in user_info.patient %}
                  {% if item.category == '1' %}                    
                    {% if item.debuff %}
                      <li><a class="app-menu__item" id='{{item._id}}' style="background-color:coral">
                    {% else %}
                      <li><a class="app-menu__item" id='{{item._id}}'>
                    {% endif %}
                      <i class="app-menu__icon fa fa-dashboard"></i>
                    {% if item.buff %}
                      <span class="app-menu__label">{{item.basicInfo.name}}</span><i class="fa fa-flag" style="color:crimson"></i></a>
                    {% else %}
                      <span class="app-menu__label">{{item.basicInfo.name}}</span><i class="fa fa-flag-o"></i></a>
                    {% endif %}
                    </li>
                  {% endif %}
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a style="color:white;margin-left:30px">
                 25°-35°患者 &nbsp;&nbsp;&nbsp;
              </a><a data-toggle="collapse" data-parent="#accordion"  href="#collapseThree"><i class="fa fa-chevron-down" style="color:white"></i></a>
            </h4>
          </div>
          <div id="collapseThree" class="panel-collapse collapse" style="color:white">
            <div class="panel-body">
              <ul class="app-menu">
                {% for item in user_info.patient %}
                  {% if item.category == '2' %}
                    {% if item.debuff %}
                      <li><a class="app-menu__item" id='{{item._id}}' style="background-color:coral">
                    {% else %}
                      <li><a class="app-menu__item" id='{{item._id}}'>
                    {% endif %}
                      <i class="app-menu__icon fa fa-dashboard"></i>
                    {% if item.buff %}
                      <span class="app-menu__label">{{item.basicInfo.name}}</span><i class="fa fa-flag" style="color:crimson"></i></a>
                    {% else %}
                      <span class="app-menu__label">{{item.basicInfo.name}}</span><i class="fa fa-flag-o"></i></a>
                    {% endif %}
                    </li>
                  {% endif %}
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a style="color:white;margin-left:30px">
                 35°-45°患者 &nbsp;&nbsp;&nbsp;
              </a><a data-toggle="collapse" data-parent="#accordion"  href="#collapseFour"><i class="fa fa-chevron-down" style="color:white"></i></a>
            </h4>
          </div>
          <div id="collapseFour" class="panel-collapse collapse"  style="color:white">
            <div class="panel-body">
              <ul class="app-menu">
                {% for item in user_info.patient %}
                  {% if item.category == '3' %}
                    {% if item.debuff %}
                      <li><a class="app-menu__item" id='{{item._id}}' style="background-color:coral">
                    {% else %}
                      <li><a class="app-menu__item" id='{{item._id}}'>
                    {% endif %}
                      <i class="app-menu__icon fa fa-dashboard"></i>
                    {% if item.buff %}
                      <span class="app-menu__label">{{item.basicInfo.name}}</span><i class="fa fa-flag" style="color:crimson"></i></a>
                    {% else %}
                      <span class="app-menu__label">{{item.basicInfo.name}}</span><i class="fa fa-flag-o"></i></a>
                    {% endif %}
                    </li>
                  {% endif %}
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
      </div>



    </aside>

    <main class="app-content">
      <div class="row">
        <div class="col-md-6 col-lg-3">
          <div class="widget-small primary coloured-icon"><i class="icon fa fa-users fa-3x"></i>
            <div class="info">
              <h4 id="name">姓名：</h4>
              <h4 id="age">年龄：</h4>
              <h4 id="gender">性别：</h4>
            </div>
          </div>
        </div>
        <div class="col-md-6 col-lg-3">
          <div class="widget-small info coloured-icon"><i class="icon fa fa-thumbs-o-up fa-3x"></i>
            <div class="info">
                <h4 id="treatment_time">治疗时间：</h4>
                <h4 id="last_time">上次复查时间:</h4>
            </div>
          </div>
        </div>
        <div class="col-md-6 col-lg-3">
          <div class="widget-small primary coloured-icon"><i class="icon fa fa-clock-o fa-3x"></i>
            <div class="info">
                <h4 id="sug_wear_time">目前建议穿戴时间:</h4>
            </div>
          </div>
        </div>
        <div class="col-md-6 col-lg-3">
          <div class="widget-small info coloured-icon"><i class="icon fa fa-thumbs-o-up fa-3x"></i>
            <div class="info">
                <h4 id="sport_time">运动量：</h4>
            </div>
          </div>
        </div>
      </div>



      <div class="panel-group" id="accordion">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion" 
                 href="#collapseInfo" style="margin-left:40%">
                 诊断历史<i class="fa fa-angle-double-down"></i>
              </a>
            </h4>
          </div>
          <div id="collapseInfo" class="panel-collapse collapse in" style="margin-left:0%">
            <div class="panel-body">
              <table class="table">
                <thead>
                <tr>
                    <th>诊断日期</th>
                    <th>姓名</th>
                    <th>检查项目</th>
                    <th>检查情况</th>
                    <th>建议最小佩戴时间</th>
                </tr>
                </thead>

                <tbody id="treatment_history">

                </tbody>
            </table>

            </div>
          </div>
        </div>
      </div>


      <!-- <div id="slider" style="width:1000px;height:12px;margin-left: 0%;margin-top:30px"></div>
      <span style="margin-bottom: 30px;margin-left: 0%;font-size: 20px">30天前 ———— 0天前数据</span> -->

      <div class="row" style="margin-left:0%">
        <div class="col-md-6">
          <div class="tile" style="width:1500px">
            <h3 class="tile-title">患者佩戴时间数据</h3>
              <div id="patientTime" style="width: 1500px; height: 422px;"></div>
          </div>
        </div>
        <br>
      </div>
      <div class="row" style="margin-left:0%">
        <div class="col-md-6">
          <div class="tile" style="width:1100px">
            <h3 class="tile-title">压力传感器数据</h3>
              <div id="pressureData" style="width: 1100px; height: 422px;"></div>
              <div id="pressureData" style="width: 1100px; height: 422px;"></div>
              <div id="pressureData" style="width: 1100px; height: 422px;"></div>
          </div>
        </div>
        <br>
      </div>
    </main>
    <script src="https://cdn.staticfile.org/popper.js/1.15.0/esm/popper.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="../public/js/main.js"></script>
    <!-- The javascript plugin to display page loading on top-->
    <script src="https://cdn.staticfile.org/pace/1.0.2/pace.min.js"></script>
    <!-- Page specific javascripts-->
    <script type="text/javascript" src="../public/js/chart.js"></script>
    <script type="text/javascript">

    // 患者被点击
    $('.app-menu__item').click((tag) => {
      const { id } = tag.currentTarget;
      $('.app-menu__item').removeClass('active');
      $(`#${id}`).addClass('active')
      $.post('/patientInfo',{id},(data) => {
        $('#name').html(`姓名：${data.basicInfo.name}`);
        $('#age').html(`年龄：${data.basicInfo.age}`);
        if (data.basicInfo.gender === true) {
          $('#gender').html(`性别：男`);
        } else {
          $('#gender').html(`性别：女`);
        }
        $('#treatment_time').html(`治疗时间：${data.basicInfo.treatment_time}`);
        $('#last_time').html(`上次复查时间：${data.treatment_history[data.treatment_history.length-1].date}`)
        $('#sug_wear_time').html(`目前建议穿戴时间：${data.basicInfo.sug_wear_time}h`)
        // 诊断历史的html
        let treatment_history = '';
        for (item of data.treatment_history) {
          // console.log(item)
          treatment_history += `
          <tr>
            <td>${item.date}</td>
            <td>${data.basicInfo.name}</td>
            <td>${item.project}</td>
            <td>${item.info}</td>
            <td>${item.min_wear_time}</td>
          </tr>`
        }

        $('#treatment_history').html(treatment_history)
      })
    })

    // 标记用户
    $('.fa.fa-flag').click((tag) => {
      const { id } = tag.currentTarget.parentElement
      // console.log(id);
      $.post('/buffPatient',{id},(data) => {
        // console.log(data);
        console.log(tag.currentTarget)
        if (data === true) {
          tag.currentTarget.css('color','crimson')
        }
      })
    })

    // 取消标记用户
    $('.fa.fa-flag-o').click((tag) => {
      const { id } = tag.currentTarget.parentElement
      // console.log(id);
      $.post('/buffPatient',{id},(data) => {
        // console.log(data);
        if (data === true) {
          tag.currentTarget.css('color','crimson')
        }
      })
    })

      var patient_time = echarts.init(document.getElementById('patientTime'));
      var pressure_data = echarts.init(document.getElementById('pressureData'));
      time_option = {
            title: {
                text: '患者穿戴时间'
            },
            tooltip: {
                trigger: 'axis'
            },
            xAxis: {
                data: ["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"]
            },
            yAxis: {
                type: 'value',
                max: 24,
            },
            toolbox: {
                left: 'center',
                feature: {
                    dataZoom: {
                        yAxisIndex: 'none'
                    },
                    restore: {},
                    saveAsImage: {}
                }
            },
            dataZoom: [{
                startValue: '2014-06-01'
            }, {
                type: 'inside'
            }],
            series: {
                name: '患者穿戴时间',
                type: 'line',
                smooth: true,
                areaStyle: {
                    color: 'rgba(0,230,1,0.1)',
                },
                data: [19,23,24,15,15,21,23,22,22,22,21,24,22,24,23,21,20,24,16,23,22,21,17,19,23,21,22,22,17,22,0],
                markLine: {
                    silent: true,
                    data: [{
                        yAxis: 22,
                    }]
                }
            }
        };
        pressure_option = {
            title: {
                text: '压力传感器数据'
            },
            tooltip: {
                trigger: 'axis'
            },
            xAxis: {
                data: ["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"]
            },
            yAxis: {
                type: 'value',
                max: 24,
            },
            toolbox: {
                left: 'center',
                feature: {
                    dataZoom: {
                        yAxisIndex: 'none'
                    },
                    restore: {},
                    saveAsImage: {}
                }
            },
            dataZoom: [{
                startValue: '2014-06-01'
            }, {
                type: 'inside'
            }],
            series: [{
                name: '传感器1',
                type: 'line',
                smooth: true,
                areaStyle: {
                    color: 'rgba(200,0,0,0.1)',
                },
                data: [19,23,24,15,15,21,23,22,22,22,21,24,22,24,23,21,20,24,16,23,22,21,17,19,23,21,22,22,17,22,0],
                markLine: {
                    silent: true,
                    data: [{
                        yAxis: 22,
                    }]
                }
            },
            {
              name: '传感器2',
                type: 'line',
                smooth: true,
                areaStyle: {
                    color: 'rgba(0,0,200,0.1)',
                },
                data: [17,19,23,21,22,22,17,22,19,23,24,15,15,21,23,22,22,22,21,24,22,24,23,21,20,24,16,23,22,21,0],
                markLine: {
                    silent: true,
                    data: [{
                        yAxis: 22,
                    }]
                }
            },
            {
              name: '传感器3',
                type: 'line',
                smooth: true,
                areaStyle: {
                    color: 'rgba(0,200,0,0.1)',
                },
                data: [12,24,21,21,22,22,24,15,15,21,23,22,17,22,19,23,22,16,23,22,22,21,24,22,24,23,21,20,24,21,0],
                markLine: {
                    silent: true,
                    data: [{
                        yAxis: 22,
                    }]
                }
            }]
        };
        patient_time.setOption(time_option);
        pressure_data.setOption(pressure_option);

    </script>
    <!-- Google analytics script-->
    <!-- <script type="text/javascript">
      if(document.location.hostname == 'pratikborsadiya.in') {
      	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      	ga('create', 'UA-72504830-1', 'auto');
      	ga('send', 'pageview');
      }
    </script> -->
  
</body><div><div class="gr_-editor gr-iframe-first-load" style="display: none;"><div class="gr_-editor_back"></div><iframe class="gr_-ifr gr-_dialog-content" src="../public/assets/saved_resource.html"></iframe></div></div><grammarly-card><div></div></grammarly-card><span class="gr__tooltip"><span class="gr__tooltip-content"></span><i class="gr__tooltip-logo"></i><span class="gr__triangle"></span></span></html>