<!DOCTYPE html>
<!-- saved from url=(0047)http://pratikborsadiya.in/vali-admin/index.html -->
<html lang="en" class="gr__pratikborsadiya_in">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>脊柱侧弯患者管理系统</title>
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Main CSS-->
    <link rel="stylesheet" type="text/css" href="../public/css/main.css">
    <!-- Font-icon css-->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- <link href="https://cdn.staticfile.org/font-awesome/5.8.1/css/all.min.css" rel="stylesheet"> -->
    
    <!-- slider -->
    <link rel="stylesheet" href="https://cdn.staticfile.org/jqueryui/1.12.1/jquery-ui.css">
    <script src="https://cdn.staticfile.org/jquery/3.4.0/jquery.js"></script>
    <script src="https://cdn.staticfile.org/jqueryui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdn.staticfile.org/echarts/4.2.1-rc1/echarts.common.js"></script>
    <script src="../public/js/echarts-gl.js"></script>
    <script src="../public/js/simplex.js"></script>
  </head>
  <body class="app sidebar-mini rtl  pace-done" data-gr-c-s-loaded="true"><div class="pace  pace-inactive"><div class="pace-progress" data-progress-text="100%" data-progress="99" style="transform: translate3d(100%, 0px, 0px);">
  <div class="pace-progress-inner"></div>
</div>
<div class="pace-activity"></div></div>
    <!-- Navbar-->
    <header class="app-header"><a class="app-header__logo" href="http://pratikborsadiya.in/vali-admin/index.html">Spms</a>
      <!-- Sidebar toggle button--><a class="app-sidebar__toggle" href="http://pratikborsadiya.in/vali-admin/index.html#" data-toggle="sidebar" aria-label="Hide Sidebar"></a>
      <!-- Navbar Right Menu-->
      <ul class="app-nav">
        <!-- <li class="app-search">
          <input class="app-search__input" type="search" placeholder="Search">
          <button class="app-search__button"><i class="fa fa-search"></i></button>
        </li> -->
        <!--Notification Menu-->
        <!-- 消息提醒 -->
        <li class="dropdown"><a class="app-nav__item" href="http://pratikborsadiya.in/vali-admin/index.html#" data-toggle="dropdown" aria-label="Show notifications"><i class="fa fa-bell-o fa-lg"></i></a>
          <ul class="app-notification dropdown-menu dropdown-menu-right">
            <li class="app-notification__title">You have 4 new notifications.</li>
            <div class="app-notification__content">
              <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-primary"></i><i class="fa fa-envelope fa-stack-1x fa-inverse"></i></span></span>
                  <div>
                    <p class="app-notification__message">Lisa sent you a mail</p>
                    <p class="app-notification__meta">2 min ago</p>
                  </div></a></li>
              <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-danger"></i><i class="fa fa-hdd-o fa-stack-1x fa-inverse"></i></span></span>
                  <div>
                    <p class="app-notification__message">Mail server not working</p>
                    <p class="app-notification__meta">5 min ago</p>
                  </div></a></li>
              <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-success"></i><i class="fa fa-money fa-stack-1x fa-inverse"></i></span></span>
                  <div>
                    <p class="app-notification__message">Transaction complete</p>
                    <p class="app-notification__meta">2 days ago</p>
                  </div></a></li>
              <div class="app-notification__content">
                <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-primary"></i><i class="fa fa-envelope fa-stack-1x fa-inverse"></i></span></span>
                    <div>
                      <p class="app-notification__message">Lisa sent you a mail</p>
                      <p class="app-notification__meta">2 min ago</p>
                    </div></a></li>
                <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-danger"></i><i class="fa fa-hdd-o fa-stack-1x fa-inverse"></i></span></span>
                    <div>
                      <p class="app-notification__message">Mail server not working</p>
                      <p class="app-notification__meta">5 min ago</p>
                    </div></a></li>
                <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-success"></i><i class="fa fa-money fa-stack-1x fa-inverse"></i></span></span>
                    <div>
                      <p class="app-notification__message">Transaction complete</p>
                      <p class="app-notification__meta">2 days ago</p>
                    </div></a></li>
              </div>
            </div>
            <li class="app-notification__footer"><a href="http://pratikborsadiya.in/vali-admin/index.html#">See all notifications.</a></li>
          </ul>
        </li>
        <!-- User Menu-->
        <!-- 用户菜单 -->
        <li class="dropdown"><a class="app-nav__item" href="http://pratikborsadiya.in/vali-admin/index.html#" data-toggle="dropdown" aria-label="Open Profile Menu"><i class="fa fa-user fa-lg"></i></a>
          <ul class="dropdown-menu settings-menu dropdown-menu-right">
            <li><a class="dropdown-item" href="http://pratikborsadiya.in/vali-admin/page-user.html"><i class="fa fa-cog fa-lg"></i> Settings</a></li>
            <li><a class="dropdown-item" href="http://pratikborsadiya.in/vali-admin/page-user.html"><i class="fa fa-user fa-lg"></i> Profile</a></li>
            <li><a class="dropdown-item" href="http://pratikborsadiya.in/vali-admin/page-login.html"><i class="fa fa-sign-out fa-lg"></i> Logout</a></li>
          </ul>
        </li>
      </ul>
    </header>
    <!-- Sidebar menu-->
    {# <div class="app-sidebar__overlay" data-toggle="sidebar"></div> #}
    <aside class="app-sidebar">
        <h4 class="panel-title">
            <a href="" style="color:white;margin-left:30px">
            穿戴数据及日志
            </a>
        </h4>
        <br>
        <h4 class="panel-title">
            <a href="/fault" style="color:white;margin-left:30px">
            故障检测
            </a>
        </h4>
    </aside>

    <main class="app-content">
      <div class="row">
        <div class="col-md-6 col-lg-3">
          <div class="widget-small primary coloured-icon"><i class="icon fa fa-users fa-3x"></i>
            <div class="info">
              <h4 id="name">姓名：</h4>
              <h4 id="age">年龄：</h4>
              <h4 id="gender">性别：</h4>
            </div>
          </div>
        </div>
        <div class="col-md-6 col-lg-3">
          <div class="widget-small info coloured-icon"><i class="icon fa fa-thumbs-o-up fa-3x"></i>
            <div class="info">
                <h4 id="treatment_time">治疗时间：</h4>
                <h4 id="last_time">上次复查时间:</h4>
            </div>
          </div>
        </div>
        <div class="col-md-6 col-lg-3">
          <div class="widget-small primary coloured-icon"><i class="icon fa fa-clock-o fa-3x"></i>
            <div class="info">
                <h4 id="sug_wear_time">目前建议穿戴时间:</h4>
            </div>
          </div>
        </div>
        <div class="col-md-6 col-lg-3">
          <div class="widget-small info coloured-icon"><i class="icon fa fa-thumbs-o-up fa-3x"></i>
            <div class="info">
                <h4 id="sport_time">运动量：</h4>
            </div>
          </div>
        </div>
      </div>

      <!-- <div id="slider" style="width:1000px;height:12px;margin-left: 0%;margin-top:30px"></div>
      <span style="margin-bottom: 30px;margin-left: 0%;font-size: 20px">30天前 ———— 0天前数据</span> -->
        <div class="row" style="margin-left:0%">
            <div class="col-md-4">
                <div id="pressure_detail" style="width: 450px; height: 900px; margin-top:70px;margin-left: 30px"></div>
            </div>
            <div class="col-md-8">
                <div class="tile" style="width:1100px">
                <h3 class="tile-title">压力传感器数据</h3>
                    <div id="pressureData1" style="width: 1000px; height: 300px;"></div>
                    <div id="pressureData2" style="width: 1000px; height: 300px;"></div>
                    <div id="pressureData3" style="width: 1000px; height: 300px;"></div>
                </div>
            </div>
        </div> 

        <div class="row" style="margin-left:0%">
            <div class="col-md-6">
                <div class="tile" style="width:1600px">
                    <h3 class="tile-title">患者佩戴时间数据</h3>
                    <div id="patientTime" style="width: 1700px; height: 422px;"></div>
                </div>
            </div>
        </div>

        <div id="3d" style="width:1400px;height:700px;margin-bottom:100px">
        
        </div>
      </div>
    </main>
    <script src="https://cdn.staticfile.org/popper.js/1.15.0/esm/popper.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
    {# <script src="../public/js/main.js"></script> #}
    <!-- The javascript plugin to display page loading on top-->
    <script src="https://cdn.staticfile.org/pace/1.0.2/pace.min.js"></script>
    <!-- Page specific javascripts-->
    {# <script type="text/javascript" src="../public/js/chart.js"></script> #}
    <script>

    // 患者被点击
    $('.app-menu__item').click((tag) => {
      const { id } = tag.currentTarget;
      $('.app-menu__item').removeClass('active');
      $(`#${id}`).addClass('active')
      $.post('/patientInfo',{id},(data) => {
        $('#name').html(`姓名：${data.basicInfo.name}`);
        $('#age').html(`年龄：${data.basicInfo.age}`);
        if (data.basicInfo.gender === true) {
          $('#gender').html(`性别：男`);
        } else {
          $('#gender').html(`性别：女`);
        }
        $('#treatment_time').html(`治疗时间：${data.basicInfo.treatment_time}`);
        $('#last_time').html(`上次复查时间：${data.treatment_history[data.treatment_history.length-1].date}`)
        $('#sug_wear_time').html(`目前建议穿戴时间：${data.basicInfo.sug_wear_time}h`)
        // 诊断历史的html
        let treatment_history = '';
        for (item of data.treatment_history) {
          // console.log(item)
          treatment_history += `
          <tr>
            <td>${item.date}</td>
            <td>${data.basicInfo.name}</td>
            <td>${item.project}</td>
            <td>${item.info}</td>
            <td>${item.min_wear_time}</td>
          </tr>`
        }

        $('#treatment_history').html(treatment_history)
      })
    })

    // 标记用户
    $('.fa.fa-flag').click((tag) => {
      const { id } = tag.currentTarget.parentElement
      // console.log(id);
      $.post('/buffPatient',{id},(data) => {
        // console.log(data);
        console.log(tag.currentTarget)
        if (data === true) {
          tag.currentTarget.css('color','crimson')
        }
      })
    })

    // 取消标记用户
    $('.fa.fa-flag-o').click((tag) => {
      const { id } = tag.currentTarget.parentElement
      // console.log(id);
      $.post('/buffPatient',{id},(data) => {
        // console.log(data);
        if (data === true) {
          tag.currentTarget.css('color','crimson')
        }
      })
    })
    let patient_time = echarts.init(document.getElementById('patientTime'));
    let pressure_data1 = echarts.init(document.getElementById('pressureData1'));
    let pressure_data2 = echarts.init(document.getElementById('pressureData2'));
    let pressure_data3 = echarts.init(document.getElementById('pressureData3'));
    let pressure_detail = echarts.init(document.getElementById('pressure_detail'));
    let _3d = echarts.init(document.getElementById('3d'));

    time_option = {
      title: {
          text: '患者穿戴时间'
      },
      tooltip: {
          trigger: 'axis'
      },
      xAxis: {
          data: ["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"]
      },
      yAxis: {
          type: 'value',
          max: 24,
      },
      toolbox: {
          left: 'center',
          feature: {
              dataZoom: {
                  yAxisIndex: 'none'
              },
              restore: {},
              saveAsImage: {}
          }
      },
      dataZoom: [{
          startValue: '2014-06-01'
      }, {
          type: 'inside'
      }],
      series: {
          name: '患者穿戴时间',
          type: 'line',
          smooth: true,
          areaStyle: {
              color: 'rgba(0,230,1,0.1)',
          },
          data: [19,23,24,15,15,21,23,22,22,22,21,24,22,24,23,21,20,24,16,23,22,21,17,19,23,21,22,22,17,22,0],
          markLine: {
              silent: true,
              data: [{
                  yAxis: 22,
              }]
          }
      }
  };

    pressure_option = {
        title: {
            text: '压力传感器数据'
        },
        tooltip: {
            trigger: 'axis'
        },
        xAxis: {
            data: ["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"]
        },
        yAxis: {
            type: 'value',
            min: 0,
            max: 100,
        },
        toolbox: {
            left: 'center',
            feature: {
                dataZoom: {
                    yAxisIndex: 'none'
                },
                restore: {},
                saveAsImage: {}
            }
        },
        dataZoom: [{
            startValue: '2014-06-01'
        }, {
            type: 'inside'
        }],
        series: [{
            name: '传感器1',
            type: 'line',
            smooth: true,
            areaStyle: {
                color: 'rgba(200,0,0,0.1)',
            },
            data: [19,23,24,15,15,21,23,22,22,22,21,24,22,24,23,21,20,24,16,23,22,21,17,19,23,21,22,22,17,22,0],
            markLine: {
                silent: true,
                data: [{
                    yAxis: 22,
                }]
            }
        }]
    };

    var labelRight = 
    {
        normal: {
            position: 'right'
        }
    };

      var labelLeft = 
      {
        normal: {
            position: 'left'
        }
    };

    pressure_detail_option =
    {
      title: {
          text: '详细数据',
      },
      tooltip : {
          trigger: 'axis',
          axisPointer : {            // 坐标轴指示器，坐标轴触发有效
              type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
          }
      },
      grid: {
          top: 80,
          bottom: 30,
      },
      xAxis: {
          type : 'value',
          position: 'top',
          splitLine: {lineStyle:{type:'dashed'}},
      },
      yAxis: {
          type : 'category',
          axisLine: {show: false},
          axisLabel: {show: false},
          axisTick: {show: true},
          splitLine: {show: false},
          data : ['左上', '右中', '左下']
      },
      series : [
          {
            name:'压力值',
            type:'bar',
            stack: '总量',
            barWidth: 65,
            label: {
                normal: {
                    show: true,
                    formatter: '{b}'
                }
            },
            data:[
                {value: 37, label:labelLeft},
                {value: -34, label: labelRight},
                {value: 47, label:labelLeft},
            ],
            itemStyle: {
              normal: {
                color: function (params){
                          var colorList = ['rgb(255,0,0)','rgb(150,0,0)','rgb(30,0,0)'];
                          return colorList[params.dataIndex];
                      }
              }
            },
          }
      ]
};
{# $.getScript('../public/js/simplex.js').done(function () { #}
var noise = new SimplexNoise(Math.random);
function generateData(theta, min, max) {
    var data = [];
    for (var i = 0; i <= 2; i++) {
        for (var j = 0; j <= 2; j++) {
            var value = noise.noise2D(i / 20, j / 20);
            valMax = Math.max(valMax, value);
            valMin = Math.min(valMin, value);
            data.push([i, j, 10*Math.random()]);
        }
    }
    return data;
}
var valMin = Infinity;
var valMax = -Infinity;
var data = [[0,0,59],[0,1,43],[0,2,44],[1,0,50],[1,1,46],[1,2,50],[2,0,45],[2,1,54],[2,2,41]];

_3d.setOption(option = {
    visualMap: {
        show: true,
        min: 0,
        max: 10,
        inRange: {
            color: ['#313695', '#4575b4', '#4575b4', '#4575b4', '#4575b4', '#4575b4', '#4575b4', '#4575b4', '#4575b4', '#4575b4', '#4575b4']
        }
    },
    xAxis3D: {
        type: 'value'
    },
    yAxis3D: {
        type: 'value'
    },
    zAxis3D: {
        type: 'value',
        max: 70,
        min: 30,
    },
    grid3D: {
        axisLine: {
            lineStyle: { color: '#fff' }
        },
        axisPointer: {
            lineStyle: { color: '#fff' }
        },
        viewControl: {
            // autoRotate: true
        },
        light: {
            main: {
                shadow: false,
                quality: 'ultra',
                intensity: 1.5
            }
        }
    },
    series: [{
        type: 'bar3D',
        data: data,
        shading: 'lambert',
        label: {
            formatter: function (param) {
                return param.value[2].toFixed(1);
            }
        },
        itemStyle: {
          normal: {
                    //每个柱子的颜色即为colorList数组里的每一项，如果柱子数目多于colorList的长度，则柱子颜色循环使用该数组
            color: function (params) {
                var colorList = ['#6666ff', '#6666ff', '#6666ff', '#6666ff', '#6666ff', '#6666ff', '#6666ff', '#6666ff', '#6666ff']; //每根柱子的颜色
                return colorList[params.dataIndex];
            }
        }
        }
    }]
});

{# }); #}

        patient_time.setOption(time_option);
        pressure_data1.setOption(pressure_option);
        pressure_data2.setOption(pressure_option);
        pressure_data3.setOption(pressure_option);
        pressure_detail.setOption(pressure_detail_option)
        pressure_data1.on('click', function (params) {
          console.log(params)
        });

    </script>
    <!-- Google analytics script-->
    <!-- <script type="text/javascript">
      if(document.location.hostname == 'pratikborsadiya.in') {
      	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      	ga('create', 'UA-72504830-1', 'auto');
      	ga('send', 'pageview');
      }
    </script> -->
  
</body><div><div class="gr_-editor gr-iframe-first-load" style="display: none;"><div class="gr_-editor_back"></div><iframe class="gr_-ifr gr-_dialog-content" src="../public/assets/saved_resource.html"></iframe></div></div><grammarly-card><div></div></grammarly-card><span class="gr__tooltip"><span class="gr__tooltip-content"></span><i class="gr__tooltip-logo"></i><span class="gr__triangle"></span></span></html>